<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>AI环评噪声现状评价助手</title>
  <link rel="stylesheet" href="./main.css" />
</head>
<body>
  <div id="app"></div>

  <script>
    var webSdkScript = document.createElement('script');
    webSdkScript.src = 'https://lf-cdn.coze.cn/obj/unpkg/flow-platform/builder-web-sdk/0.1.1-beta.1/dist/umd/index.js';
    document.head.appendChild(webSdkScript);

    webSdkScript.onload = function () {
      try {
        window.cozeClient = new CozeWebSDK.AppWebSDK({
          token: 'sat_NFNd0Le8YwH2jF2T4Z9ZQuo16AFTpmTh6CTWMamnCGqkX5UcJ0MXhvKCrwquqWYC',
          appId: '7576219529463365675',
          container: '#app',
          userInfo: {
            id: 'user_001',
            url: 'https://lf-coze-web-cdn.coze.cn/obj/eden-cn/lm-lgvj/ljhwZthlaukjlkulzlp/coze/coze-logo.png',
            nickname: 'User'
          },
          ui: {
            className: 'custom-coze-sdk'
          }
        });

        console.log('✅ 扣子 Web SDK 初始化成功');
      } catch (error) {
        console.error('❌ SDK 初始化失败:', error);
        document.getElementById('app').innerHTML =
          '<div style="padding: 20px; text-align: center; color: #f56c6c;">' +
          '初始化失败：' + error.message +
          '</div>';
      }
    };

    webSdkScript.onerror = function () {
      console.error('❌ SDK 脚本加载失败');
      document.getElementById('app').innerHTML =
        '<div style="padding: 20px; text-align: center; color: #f56c6c;">' +
        'SDK 加载失败,请检查网络连接' +
        '</div>';
    };
  </script>

  <script>
    window.addEventListener('beforeunload', function() {
      if (window.cozeClient) {
        window.cozeClient.destroy();
        console.log('扣子 Web SDK 已销毁');
      }
    });
  </script>
</body>
</html>
